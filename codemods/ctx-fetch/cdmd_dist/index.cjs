var f=Object.defineProperty;var x=Object.getOwnPropertyDescriptor;var h=Object.getOwnPropertyNames;var y=Object.prototype.hasOwnProperty;var D=(t,e)=>{for(var i in e)f(t,i,{get:e[i],enumerable:!0})},E=(t,e,i,r)=>{if(e&&typeof e=="object"||typeof e=="function")for(let n of h(e))!y.call(t,n)&&n!==i&&f(t,n,{get:()=>e[n],enumerable:!(r=x(e,n))||r.enumerable});return t};var T=t=>E(f({},"__esModule",{value:!0}),t);var N={};D(N,{handleSourceFile:()=>F,replaceDestructureAliases:()=>p,replaceReferences:()=>g});module.exports=T(N);var s=require("ts-morph");function C(t,e,i){let r=t.getImportDeclaration(e)??t.addImportDeclaration({moduleSpecifier:e});return r.getNamedImports().find(a=>a.getName()===i)??r.addNamedImport({name:i})}function u(t,e,i){let r=t.getImportDeclaration(e);if(!r)return null;let n=r.getNamedImports().find(a=>a.getName()===i);return n?n.getAliasNode()?.getText()||n.getName():null}function I(t,e){let i=[...t.getDescendantsOfKind(s.SyntaxKind.PropertyAccessExpression),...t.getDescendantsOfKind(s.SyntaxKind.BindingElement)].flatMap(r=>{let n=r.getDescendantsOfKind(s.SyntaxKind.Identifier);return e.filter(a=>n.some(o=>o.getText()===a))});return new Set(i)}function K(t,e){let i=u(t,"msw","http"),r=u(t,"msw","graphql"),n=e.getChildrenOfKind(s.SyntaxKind.PropertyAccessExpression).at(0)?.getChildrenOfKind(s.SyntaxKind.Identifier)??[],a=n.at(0);if(!a)return!1;let c=(n.at(1)??a).getText(),l=a.getText()===i&&["all","get","post","put","patch","delete","head","options"].includes(c),d=a.getText()===r&&["query","mutation"].includes(c);return l||d}function O(t){let e=t.getArguments().at(1)??null;if(e===null)return null;let i=e.getChildrenOfKind(s.SyntaxKind.Parameter),r=e.asKind(s.SyntaxKind.ArrowFunction)??e.asKind(s.SyntaxKind.FunctionExpression)??null;return r===null?null:[e.getChildrenOfKind(s.SyntaxKind.Block).at(0)??r,i,r]}function p(t){let e=t.getChildrenOfKind(s.SyntaxKind.Identifier),[i,r]=e;!i||!r||e.length===2&&r.findReferencesAsNodes().forEach(n=>n.replaceWithText(i.getText()))}function g(t,e,i){let r=!1;return t.getDescendantsOfKind(s.SyntaxKind.PropertyAccessExpression).forEach(n=>{let a=n.getChildrenOfKind(s.SyntaxKind.Identifier),o=a.at(0)?.getText(),c=a.at(-1)?.getText();if(e.includes(n.getName())&&o===i){if(!c)throw new Error("Could not find accessed identifier");r=!0,n.replaceWithText(c)}}),t.getDescendantsOfKind(s.SyntaxKind.ObjectBindingPattern).forEach(n=>{let a=[];if(n.getDescendantsOfKind(s.SyntaxKind.BindingElement).forEach(o=>{o.getDescendantsOfKind(s.SyntaxKind.Identifier).find(l=>e.includes(l.getText()))&&(p(o),a.push(o.getText()))}),a.length){r=!0;let o=a.join("|");n?.replaceWithText(n.getText().replace(new RegExp(`(,\\s*)?(${o})+(\\s*,)?`,"g"),(c,l,d,m)=>[l,m].includes(c)?c:"")),n.getDescendantsOfKind(s.SyntaxKind.Identifier).length?n.formatText():n.getAncestors().find(c=>c.getKind()===s.SyntaxKind.VariableDeclaration)?.asKindOrThrow(s.SyntaxKind.VariableDeclaration).remove()}}),r}function A(t){return t.getImportDeclarations().find(e=>e.getModuleSpecifier().getLiteralText().startsWith("msw"))!==void 0}function F(t){if(A(t))return t.getDescendantsOfKind(s.SyntaxKind.CallExpression).filter(e=>K(t,e)).forEach(e=>{let i=O(e);if(i===null)return;let[r,n]=i,[,,a]=n,o=I(r,["fetch"]);o.size&&(C(t,"msw","bypass"),r.getDescendantsOfKind(s.SyntaxKind.CallExpression).forEach(c=>{let[l,,d]=c.getChildren();l?.getText().includes("fetch")&&d?.replaceWithText(`bypass(${d.getText()})`)}),g(r,Array.from(o),a?.getName()))}),t.getFullText()}0&&(module.exports={handleSourceFile,replaceDestructureAliases,replaceReferences});
